.. _siesta1:

--------------------
Siesta 1: Basis Sets
--------------------

This exercise is intended to illustrate the definition of basis sets
with different numbers of orbitals and localization radii in
SIESTA. It is based on the H2O molecule. You will first use standard
basis sets generated by SIESTA, and then a basis set specifically
optimized for the H2O molecule. The tips at the end of this page will
help you in analyzing the results of the calculations.


Part 1: Standard basis sets
---------------------------

In the following script you will relax the structure of the H2O
molecule to find its equilibrium structure. 

.. literalinclude:: h2o.py

Run the script using three different basis sets: single-Z (SZ),
double-Z (DZ) and double-Z plus polarization (DZP). The bases are
defined in the script through these three lines::

  calc.set_fdf('PAO.EnergyShift',e_s * eV)
  calc.set_fdf('PAO.SplitNorm',0.15)
  calc.set_fdf('DM.UseSaveDM','Y')

For each of the basis sets the script will run the relaxation for
different ``EnergyShift`` parameters. Look at the results as a
function of basis size and localization radius (or energy shift).

In particular, you should look at:

* Total energy
* Bond lenghts at the relaxed structure
* Bond angles at the relaxed structure
* CPU time
* Radius of each of the orbitals
* Shape of the orbitals

You should obtain plots like

.. image:: ener.png

Try to answer these questions:

1. What is the best basis set that you have found? Why?
2. How do the results compare with experiment?  
3. What do you consider a reasonable basis for the molecule, if you need an accuracy in the geometry of about 1%??  
4. In order to assess convergence with respect to basis set size, should you compare the results with the experimental ones, or with those of a converged basis set calculation?


Part 2: Optimized basis sets
----------------------------

You will now do the same calculations as in Part 1, but now using a
basis set specifically optimized for the H2O molecule. You can find
the files in directory DZP-opt.

Read the block which defines the basis set. Compare the parameters
with those of the calculations in Part 1.

Do the runs with this basis set, and compare the results with the
previous ones.


Tips
----

Tip 1: You can see the radii of the orbitals in the output file, just after the line reading:
printput: Basis input ----------------------------------------------

Tip 2: You can look at the shape of the orbitals by plotting the contents of the ORB* files generated by SIESTA.
